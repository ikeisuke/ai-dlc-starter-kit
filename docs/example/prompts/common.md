# AI-DLC 共通知識ベース

このファイルは全フェーズで読み込まれる共通知識です。

---

## AI-DLC手法の要約

AI-DLCは、AIを開発の中心に据えた新しい開発手法です。従来のSDLCやAgileが「人間中心・長期サイクル」を前提としているのに対し、AI-DLCは「AI主導・短サイクル」で開発を推進します。

**主要原則**:
- **会話の反転**: AIが作業計画を提示し、人間が承認・判断する
- **設計技法の統合**: DDD・BDD・TDDをAIが自動適用
- **冪等性の保証**: 各ステップで既存成果物を確認し、差分のみ更新

**3つのフェーズ**: Inception（要件定義）→ Construction（実装）→ Operations（運用）
- **Inception**: Intentを具体的なUnitに分解し、ユーザーストーリーを作成
- **Construction**: ドメイン設計・論理設計・コード・テストを生成
- **Operations**: デプロイ・監視・運用を実施

**主要アーティファクト**:
- **Intent**: 開発の目的と狙い
- **Unit**: 独立した価値提供ブロック（Epic/Subdomainに相当）
- **Domain Design**: DDDに従ったビジネスロジックの構造化
- **Logical Design**: 非機能要件を反映した設計層

---

## プロジェクト情報

### プロジェクト概要
AI-DLCを使った開発をすぐに始められるスターターキット

### 技術スタック
**開発タイプ**: greenfield
**プロジェクトタイプ**: iOS

Inception Phaseで技術スタックを決定します。

### ディレクトリ構成
- `prompts/`: 各フェーズのプロンプトと履歴
- `templates/`: テンプレートファイル
- `plans/`: 実行計画
- `requirements/`: 要件定義
- `story-artifacts/`: ユーザーストーリーとUnit定義
- `design-artifacts/`: 設計成果物（ドメインモデル、論理設計等）
- `construction/`: 構築記録
- `operations/`: 運用関連

### 制約事項
- **ドキュメント読み込み制限**: ユーザーから明示的に指示されない限り、`docs/example/` 配下のファイルのみを読み込むこと。他のバージョンのドキュメントや関連プロジェクトのドキュメントは読まないこと（コンテキスト溢れ防止）

### 開発ルール

#### 人間の承認プロセス【重要】
計画作成後、必ず以下を実行する:
1. 計画ファイルのパスをユーザーに提示
2. 「この計画で進めてよろしいですか？」と明示的に質問
3. ユーザーが「承認」「OK」「進めてください」などの肯定的な返答をするまで待機
4. **承認なしで次のステップを開始してはいけない**

#### 質問と回答の記録【重要】
**独自の判断をせず、不明点はドキュメントに `[Question]` タグで記録し `[Answer]` タグを配置、ユーザーに回答を求める**。ユーザーとは対話形式でやりとりし、回答を得てから次に進む。

例:
```markdown
[Question] ユーザー認証の方式は？（OAuth, JWT, セッションベース等）
[Answer] （ユーザーの回答をここに記録）
```

#### Gitコミットのタイミング【必須】
以下のタイミングで**必ず**Gitコミットを作成する:
1. セットアップ完了時
2. Inception Phase完了時
3. 各Unit完了時
4. Operations Phase完了時

コミットメッセージ例:
- `feat: Inception Phase完了 - Intent、ユーザーストーリー、Unit定義を作成`
- `feat: [Unit名]の実装完了 - ドメインモデル、論理設計、コード、テストを作成`
- `chore: Operations Phase完了 - デプロイ、CI/CD、監視を構築`

#### コード品質基準
- 可読性: 明確な命名規則、適切なコメント
- テストカバレッジ: BDD/TDDに従ったテスト作成
- セキュリティ: 脆弱性のないコード（SQLインジェクション、XSS等の対策）
- パフォーマンス: 効率的なアルゴリズムとデータ構造

#### Git運用の原則
- コミットは論理的な単位で行う
- コミットメッセージは変更内容を明確に記述（feat/fix/chore等の接頭辞）
- プッシュ前にビルドとテストを実行

#### プロンプト履歴管理【重要】
**必ず既存の `prompts/history.md` を読み込んでから末尾に追記**してください（既存履歴を絶対に削除・上書きしない）。

追記手順:
1. `prompts/history.md` を Read tool で読み込む
2. Edit tool を使用し、`## 実行履歴` セクションの最後に新しいエントリを追加
3. 日時は `date '+%Y-%m-%d %H:%M:%S'` コマンドで取得
4. 記録項目: 日時、フェーズ名、実行内容、プロンプト、成果物、備考
5. 各エントリは `### YYYY-MM-DD HH:MM:SS - フェーズ名` で始め、`---` で区切る

**警告**: Write tool で上書きしてはいけません。必ず Edit tool で追記してください。

---

## フェーズの責務分離

- **Inception Phase**: Intentを明確化し、ユーザーストーリーとUnit定義を作成（詳細は `inception.md` 参照）
- **Construction Phase**: ドメイン設計・論理設計・コード・テストを生成（詳細は `construction.md` 参照）
- **Operations Phase**: デプロイ・CI/CD・監視を構築（詳細は `operations.md` 参照）

---

## 進捗管理と冪等性

### チェックリスト
各フェーズで以下を確認:
- [ ] 既存成果物の確認（`ls`コマンドで存在確認）
- [ ] 存在するファイルのみ読み込み（全ファイルを一度に読まない）
- [ ] 差分のみ更新（既存内容を尊重）
- [ ] 完了済みのステップはスキップ

### 既存成果物の確認手順
1. `ls` コマンドで対象ディレクトリ配下のファイルを確認
2. 存在するファイルのみ読み込む
3. 内容を確認して差分のみ更新

### 差分のみ更新するルール
- 既存ファイルがある場合は内容を読み込み、追加・変更が必要な部分のみ更新
- 完了済みのステップは再実行しない
- 進行中のステップは継続する

---

## テンプレート参照

各フェーズで使用するテンプレートは `docs/example/templates/` を参照してください。

テンプレート一覧と使用方法は `docs/example/templates/index.md` を確認してください。

---

## 追加ルール

プロジェクト固有の追加ルールや制約は `prompts/additional-rules.md` を参照してください。

各フェーズ開始時に必ず `additional-rules.md` を読み込んでください。
