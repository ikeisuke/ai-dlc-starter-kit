# 実装記録: 参照方式PoC

## 概要

- **Unit**: 001 - 参照方式PoC
- **実施日**: 2026-01-21
- **ステータス**: 完了

## 検証結果サマリー

| 環境 | 結果 | 備考 |
|------|------|------|
| Claude Code | **合格** | 3段階参照成功 |
| KiroCLI | **合格** | 3段階参照成功（指示形式調整後） |

## 検証環境

| 項目 | 値 |
|------|-----|
| Claude Code | claude-opus-4-5-20251101 |
| OS | Darwin 25.2.0 |
| 検証日 | 2026-01-21 |

## 詳細結果

### Claude Code

| レベル | 結果 | 証跡 |
|--------|------|------|
| レベル1 | 成功 | Read ツール呼び出し確認 |
| レベル2 | 成功 | 追加指示なしで自動読み込み |
| レベル3 | 成功 | 追加指示なしで自動読み込み |

### KiroCLI

#### 初回試行（失敗）

- **指示形式**: `〜を読み込んでください。`
- **結果**: レベル1は成功、レベル2は認識したが自動実行せず

#### 再試行（成功）

- **指示形式**: `**【次のアクション】** 今すぐ〜を読み込んで、内容を確認してください。`
- **結果**: 3段階すべて成功

## 発見事項

### 指示形式の環境依存性

| 指示形式 | Claude Code | KiroCLI |
|----------|-------------|---------|
| `〜を読み込んでください。` | 成功 | 認識のみ |
| `**【次のアクション】** 今すぐ〜を読み込んで、内容を確認してください。` | 成功 | 成功 |

**結論**: KiroCLI互換性のためには、より明示的な指示形式が必要。

### 推奨指示形式

Unit 002, 003 でのモジュール化では、以下の形式を使用する:

```markdown
**【次のアクション】** 今すぐ `{ファイルパス}` を読み込んで、内容を確認してください。
```

## 成果物

| 成果物 | パス |
|--------|------|
| 検証用ファイル（レベル1） | `prompts/package/prompts/common/poc-test-level1.md` |
| 検証用ファイル（レベル2） | `prompts/package/prompts/common/poc-test-level2.md` |
| 検証用ファイル（レベル3） | `prompts/package/prompts/common/poc-test-level3.md` |
| KiroCLI設定ファイル | `.kiro/agents/aidlc-poc.json` |
| 参照ガイド | `prompts/package/guides/reference-guide.md` |

## 次のステップ

- Unit 002: 共通セクション外部化（推奨指示形式を使用）
- Unit 003: AIレビューフロー外部化（推奨指示形式を使用）
