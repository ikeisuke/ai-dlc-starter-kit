# Unit 2: フェーズ遷移ガードレール強化 - 実装記録

## 概要

各フェーズで禁止されるアクションを明示し、AIがフェーズを無視して先走り実装しないようにするプロンプト修正を実施。

## 実装日

2025-12-08

## 変更ファイル一覧

| ファイル | 変更内容 |
|----------|----------|
| prompts/setup-cycle.md | 完了メッセージに「実装前にInception Phase」の警告追加 |
| docs/aidlc/prompts/inception.md | 「フェーズの責務【重要】」セクション追加（禁止事項明示） |
| docs/aidlc/prompts/construction.md | バックログ確認ステップ追加 + Phase 1 禁止事項強調 |
| prompts/package/prompts/inception.md | inception.md と同様の変更（パッケージ版） |
| prompts/package/prompts/construction.md | construction.md と同様の変更（パッケージ版） |

## 変更詳細

### 1. setup-cycle.md

完了メッセージに以下の警告を追加：

```markdown
**重要**: Inception Phase で計画を立ててから実装してください。
セットアップ完了後すぐに実装コードを書き始めないでください。
```

### 2. inception.md / package版

「フェーズの責務【重要】」セクションを新設：

- **このフェーズで行うこと**: Intent作成、ユーザーストーリー、Unit定義
- **このフェーズで行わないこと（禁止）**: 実装コード、テストコード、設計詳細化
- **承認なしにConstruction Phaseに進んではいけない**

### 3. construction.md / package版

2箇所の変更：

1. **バックログ確認ステップ追加**（ステップ3.5）
   - Unit開始前にバックログを確認
   - Unit定義の「実装時の注意」セクションを参照

2. **Phase 1 禁止事項強調**
   - 設計フェーズでは設計ドキュメントのみ作成
   - 設計レビュー承認前にコードファイルを作成・編集してはいけない

## バックログ気づきの対応

| 気づき | 対応 |
|--------|------|
| Unit開始前のバックログ確認がステップ化されていない | construction.md にステップ3.5追加で対応 |
| コンテキストリセットのタイミング見直し | スコープ外として次サイクルに先送り |

## 受け入れ基準チェック

- [x] setup-cycle.mdの完了メッセージに警告が追加されている
- [x] inception.mdに「フェーズの責務【重要】」セクションが追加されている
- [x] construction.mdでPhase 1の禁止事項が強調されている
- [x] construction.mdにバックログ確認ステップが追加されている
- [x] パッケージ版にも同様の変更が反映されている

## テスト結果

- マークダウン構文エラー: なし
- パッケージ版と本体版の整合性: OK

## 状態

完了
