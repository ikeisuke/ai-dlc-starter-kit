# ドメインモデル: AIレビュー機能の強化

## 概要

AIレビューの設定と実行フローを定義し、人間承認前のAIレビュー自動実行メカニズムを規定する。

**注**: このUnitはプロンプトファイルの修正であり、実行可能なコードを生成するものではない。ドメインモデルは概念レベルの定義に留める。

## 概念モデル

### AIレビュー設定（MCPReviewConfig）

設定ファイル `docs/aidlc.toml` の `[rules.mcp_review]` セクションで定義。

- **mode**: 列挙型
  - `required`: AIレビュー必須（スキップには明示的な確認が必要）
  - `recommend`: AIレビュー推奨（スキップ可能）
  - `disabled`: AIレビューを行わない

### MCP可用性（MCPAvailability）

AI MCPの利用可否を表す状態。

- **available**: MCP利用可能
- **unavailable**: MCP利用不可

### レビュー実行結果（ReviewResult）

AIレビューの実行結果。

- **reviewed**: レビュー完了（指摘あり/なし）
- **skipped**: レビュースキップ（理由を記録）
- **failed**: レビュー失敗（エラー情報）

## 処理フロー

### 承認前レビューフロー

```
┌─────────────────────────────────────────────────────────────┐
│                    承認を求めるタイミング                      │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
                   ┌───────────────────┐
                   │ mode を確認        │
                   └───────────────────┘
                              │
          ┌───────────────────┼───────────────────┐
          ▼                   ▼                   ▼
    mode=disabled      mode=recommend       mode=required
          │                   │                   │
          ▼                   ▼                   ▼
    直接人間承認へ      MCPチェック          MCPチェック
                              │                   │
                    ┌─────────┴─────────┐   ┌─────┴─────┐
                    ▼                   ▼   ▼           ▼
                available         unavailable  available  unavailable
                    │                   │       │           │
                    ▼                   ▼       ▼           ▼
              AIレビュー実行      直接人間承認 AIレビュー  警告表示
                    │                          実行      確認待ち
                    ▼                           │       ┌───┴───┐
              指摘を反映                        ▼       ▼       ▼
                    │                     指摘を反映  続行    中断
                    ▼                           │       │
              人間承認へ                    人間承認へ  人間承認へ
                                           （スキップ記録）
```

## 適用タイミング（フェーズ別）

### Inception Phase
- Intent承認前
- ユーザーストーリー承認前
- Unit定義承認前

### Construction Phase
- 計画ファイル承認前
- ドメインモデル設計完了時
- 論理設計完了時
- コード生成後の確認前
- テスト完了後の確認前

### Operations Phase
- デプロイ計画承認前
- 運用ドキュメント承認前

## ユビキタス言語

- **AIレビュー**: AI MCP（Codex MCP等）による成果物の自動レビュー
- **MCP**: Model Context Protocol。外部AIエージェントとの連携プロトコル
- **レビュースキップ**: AIレビューを実行せずに人間承認へ進むこと
- **フォールバック**: MCP利用不可時の代替処理

## 不明点と質問

（なし - Unit定義とバックログで仕様が明確化されている）
