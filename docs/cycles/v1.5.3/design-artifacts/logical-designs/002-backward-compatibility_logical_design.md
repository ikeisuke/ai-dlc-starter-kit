# Unit 002: v1.5.1後方互換性の確保 - 論理設計

## 概要

このUnitはプロンプトファイル（Markdown）の修正のみであり、コード実装は含まない。
AIがプロンプトを解釈する際のフォールバックロジックを明確化する。

## 修正対象

- `prompts/setup-prompt.md`

## フォールバックロジック

```
IF docs/aidlc/prompts/setup.md が存在する
THEN プロジェクト内のファイルを読み込む
ELSE スターターキット内の package/prompts/setup.md を読み込む
```

## 修正箇所の詳細

### 修正箇所1: ケースB（行83付近）

**条件**: `aidlc.toml` が存在 & バージョン同じ

**現状の指示**:
> プロジェクト内の `docs/aidlc/prompts/setup.md` を読み込み

**修正後の指示**:
> 1. `docs/aidlc/prompts/setup.md` の存在を確認
> 2. 存在する場合: プロジェクト内のファイルを読み込む
> 3. 存在しない場合: `package/prompts/setup.md` を読み込む

### 修正箇所2: ケースC「2を選択」（行106付近）

**条件**: `aidlc.toml` が存在 & プロジェクトが古い & アップグレードしない選択

**現状の指示**:
> プロジェクト内の `docs/aidlc/prompts/setup.md` を読み込む

**修正後の指示**:
> フォールバックロジックを適用

### 修正箇所3: ケースD（行124付近）

**条件**: プロジェクトが新しい & 続行を選択

**現状の指示**:
> プロジェクト内の `docs/aidlc/prompts/setup.md` を自動で読み込み

**修正後の指示**:
> フォールバックロジックを適用

## 影響範囲

- **変更ファイル**: `prompts/setup-prompt.md` のみ
- **既存プロジェクトへの影響**: なし（スターターキット側の修正のみ）
- **動作への影響**: v1.5.0以前のプロジェクトでもサイクル開始が可能になる

## テスト観点

1. `docs/aidlc/prompts/setup.md` が存在する場合、プロジェクト内のファイルが読み込まれること
2. `docs/aidlc/prompts/setup.md` が存在しない場合、スターターキット内のファイルが読み込まれること
