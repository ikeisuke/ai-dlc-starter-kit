# ユーザーストーリー

## Epic 1: スクリプト化基盤構築（#34）

> **設計方針**: 抽象化を避け「処理のまとまり」をそのままスクリプト化する。
> 詳細は `history/construction_reset.md` を参照。

### ストーリー 1-1: 環境情報一覧の出力
**優先順位**: Must-have

As a AI-DLC利用者
I want to gh, dasel, jj等の依存ツールの状態を一覧で確認できる
So that フェーズ開始時の環境確認が1コマンドで完了する

**受け入れ基準**:
- [ ] `bin/env-info.sh` が存在する
- [ ] gh, dasel, jj, git の状態を出力する
- [ ] 出力形式が `ツール名:状態` で統一されている
- [ ] プロンプト内の環境確認がスクリプト呼び出しに置き換わっている

---

### ストーリー 1-2: 共通ラベル一括初期化
**優先順位**: Must-have

As a AI-DLC利用者
I want to バックログ管理用の共通ラベルを一括で作成できる
So that セットアップ時の手動ラベル作成（12個）が不要になる

**受け入れ基準**:
- [ ] `bin/init-labels.sh` が存在する
- [ ] backlog, type:*, priority:* ラベルを一括作成する
- [ ] 既存ラベルはスキップする
- [ ] プロンプト内のラベル作成がスクリプト呼び出しに置き換わっている

---

### ストーリー 1-3: サイクルディレクトリ初期化
**優先順位**: Must-have

As a AI-DLC利用者
I want to サイクル用ディレクトリ構造を一括で作成できる
So that セットアップ時の手動mkdir（9個）が不要になる

**受け入れ基準**:
- [ ] `bin/init-cycle-dir.sh` が存在する
- [ ] サイクルバージョンを引数で受け取る
- [ ] plans, requirements, story-artifacts等の構造を作成する
- [ ] プロンプト内のmkdirがスクリプト呼び出しに置き換わっている

---

### ストーリー 1-4: サイクルラベル操作
**優先順位**: Must-have

As a AI-DLC利用者
I want to サイクルラベルの確認と作成を一括で行える
So that インセプション時のラベル操作が簡素化される

**受け入れ基準**:
- [ ] `bin/cycle-label.sh` が存在する
- [ ] サイクルバージョンを引数で受け取る
- [ ] ラベル存在確認→なければ作成の処理を行う
- [ ] プロンプト内のラベル確認+作成がスクリプト呼び出しに置き換わっている

---

### ストーリー 1-5: Issue操作
**優先順位**: Must-have

As a AI-DLC利用者
I want to Issueへのラベル付けとCloseを簡単に行える
So that Issue操作の手順が統一される

**受け入れ基準**:
- [ ] `bin/issue-ops.sh` が存在する
- [ ] サブコマンド（label, close）で操作を選択できる
- [ ] Issue番号とラベル名を引数で受け取る
- [ ] プロンプト内のIssue操作がスクリプト呼び出しに置き換わっている

---

### ストーリー 1-6: 履歴記録
**優先順位**: Must-have

As a AI-DLC利用者
I want to 履歴ファイルへの追記を標準化されたフォーマットで行える
So that 各フェーズでの履歴記録が統一される

**受け入れ基準**:
- [ ] `bin/write-history.sh` が存在する
- [ ] フェーズ、サイクル、ステップ名等を引数で指定できる
- [ ] 日時が自動取得される
- [ ] プロンプト内のヒアドキュメントがスクリプト呼び出しに置き換わっている

---

### ストーリー 1-7: rsync同期処理
**優先順位**: Must-have

As a AI-DLC利用者
I want to prompts/package配下の同期を一括で行える
So that セットアップ時のrsync複数回実行が1コマンドになる

**受け入れ基準**:
- [ ] `bin/sync-prompts.sh` が存在する
- [ ] prompts, templates, guides, bin を同期する
- [ ] 同期先ディレクトリを引数で指定できる
- [ ] プロンプト内のrsyncがスクリプト呼び出しに置き換わっている

---

## Epic 2: パッチレベル改善（#69, #48, #39）

### ストーリー 2-1: 簡略指示「AIDLCアップデート」追加
**優先順位**: Must-have

As a AI-DLC利用者
I want to 「AIDLCアップデートして」で環境更新を開始できる
So that setup-prompt.mdを手動で指定する手間が省ける

**受け入れ基準**:
- [ ] AGENTS.mdの簡略指示テーブルに新規エントリがある
- [ ] 「AIDLCアップデート」「start upgrade」等の指示で `prompts/setup-prompt.md` が読み込まれる

---

### ストーリー 2-2: フィードバック手段の提供
**優先順位**: Must-have

As a AI-DLC利用者
I want to スターターキットへのフィードバック方法が明確である
So that 改善提案やバグ報告を適切に伝えられる

**受け入れ基準**:
- [ ] README.mdにIssue報告へのリンクがある
- [ ] フィードバック用のIssueテンプレートが存在する

---

### ストーリー 2-3: プランモード活用ガイド
**優先順位**: Must-have

As a Claude Code利用者
I want to プランモードの活用方法が文書化されている
So that 設計レビューや実装計画にプランモードを効果的に使える

**受け入れ基準**:
- [ ] `guides/plan-mode.md` が存在する
- [ ] Construction Phase Phase1での活用方法が記載されている

---

## Epic 3: UX改善（#67, #47, #37, #59）

### ストーリー 3-1: markdownlint設定対応
**優先順位**: Should-have

As a AI-DLC利用者（markdownlint未使用プロジェクト）
I want to markdownlint実行をプロジェクト設定で制御できる
So that markdownlint未インストールの環境でもエラーにならない

**受け入れ基準**:
- [ ] `aidlc.toml` に `[rules.linting]` セクションがある
- [ ] `markdown_lint = true/false` で制御できる
- [ ] プロンプト内のmarkdownlint実行が条件分岐している

---

### ストーリー 3-2: Unit完了条件の明確化
**優先順位**: Should-have

As a AI-DLC利用者
I want to Unit開始時に完了条件が提示され、終了時に確認される
So that 完了基準が明確になり、作業漏れが防止される

**受け入れ基準**:
- [ ] Unit開始時に受け入れ基準から完了条件チェックリストが生成される
- [ ] Unit終了時にチェックリストに基づいて確認が行われる
- [ ] 未達成条件がある場合は警告が表示される

---

### ストーリー 3-3: フェーズ間連携の改善
**優先順位**: Should-have

As a AI-DLC利用者
I want to セットアップで決めた内容がインセプションに引き継がれる
So that 同じ質問に重複して回答する手間が省ける

**受け入れ基準**:
- [ ] セットアップで決めたIntent/スコープが保存される
- [ ] インセプション開始時に確認済み内容として読み込まれる
- [ ] 追加要件がある場合のみ質問される

---

### ストーリー 3-4: worktreeサブディレクトリ化
**優先順位**: Should-have

As a AI-DLC利用者
I want to git worktreeがプロジェクト配下に作成される
So that AIエージェントのカレントディレクトリから移動しやすくなる

**受け入れ基準**:
- [ ] worktree作成先が `.worktree/` サブディレクトリに変更されている
- [ ] worktree関連のプロンプト記述が更新されている

---

## Epic 4: 分析・準備（#45）

### ストーリー 4-1: プロンプト最適化準備
**優先順位**: Could-have

As a AI-DLC開発者
I want to プロンプト指示の現状を分析したレポートがある
So that 次サイクルでの最適化作業の土台ができる

**受け入れ基準**:
- [ ] プロンプト指示の分析レポートが作成されている
- [ ] 重複・冗長な指示が特定されている
- [ ] 次サイクルへの引継ぎ事項がバックログに記録されている
