# 実装記録: プロンプト最適化準備

## 概要

AI-DLCプロンプトの現状を分析し、次サイクルでの最適化作業の土台を作成した。

## 成果物

| ファイル | 説明 |
|----------|------|
| `docs/cycles/v1.8.0/requirements/prompt-analysis.md` | 分析レポート |
| `docs/cycles/v1.8.0/design-artifacts/domain-models/015-prompt-optimization-prep_domain_model.md` | ドメインモデル設計 |
| `docs/cycles/v1.8.0/design-artifacts/logical-designs/015-prompt-optimization-prep_logical_design.md` | 論理設計 |

## 分析結果サマリ

| 項目 | 値 |
|------|-----|
| 分析対象ファイル数 | 6 |
| 総行数 | 4,099行 |
| 総文字数 | 156,992文字 |
| 推定重複行数 | 約615行 |
| 削減見込み | 約514行（約12%） |

## 作成したバックログIssue

| Issue | タイトル | 優先度 |
|-------|---------|--------|
| #74 | 参照方式のPoC確立 | 最高 |
| #75 | 参照漏れチェックの仕組み構築 | 高 |
| #76 | 共通セクションの外部ファイル化 | 高 |
| #77 | AIレビューフローの外部化 | 高 |
| #78 | 設定確認スクリプトの整備 | 中 |
| #79 | Operations Phaseサイズチェック追加 | 中 |
| #80 | 後方互換性コードのdeprecation準備 | 低 |

## 重要な前提条件

5つのフェーズプロンプト（setup, setup-prompt, inception, construction, operations）は**同時には読み込まれない**。各フェーズで1つのプロンプトのみが読み込まれる。

したがって、重複の問題は「ユーザー体験への影響」ではなく「**メンテナンス性の問題**」である。

## 次サイクルへの引継ぎ

1. **参照方式のPoC確立**を最優先で実施（Issue #74）
2. PoCが成功したら、共通セクションとAIレビューフローの外部化を並行実施
3. 移行計画: v1.9.0で開始、v1.10.0で完了、v2.0.0で後方互換性削除

## 完了状態

- [x] プロンプト現状分析
- [x] ドメインモデル設計
- [x] 論理設計
- [x] 設計レビュー（Codex）
- [x] 分析レポート作成
- [x] バックログIssue作成
