# Unit 014 計画書: worktreeサブディレクトリ化

## 概要

git worktreeの作成先を親ディレクトリ（`../project-cycle`）からプロジェクト配下のサブディレクトリ（`.worktree/cycle-vX.X.X`）に変更する。

## 目的

- AIエージェントからのアクセスしやすさ向上（プロジェクト配下にあることで参照が容易）
- ディレクトリ構成の統一化（プロジェクト関連ファイルをプロジェクト内に集約）

## 変更対象ファイル

| ファイル | 変更内容 |
|---------|---------|
| `prompts/package/prompts/setup.md` | worktreeパス記述の変更 |
| `prompts/package/guides/ai-agent-allowlist.md` | allowlistパターンの確認（変更不要の見込み） |

## 変更詳細

### パス変更

| 項目 | 変更前 | 変更後 |
|------|--------|--------|
| パス形式 | `../[プロジェクト名]-{{CYCLE}}` | `.worktree/cycle-{{CYCLE}}` |
| 例 | `../ai-dlc-starter-kit-v1.8.0` | `.worktree/cycle-v1.8.0` |

### 主要変更箇所（setup.md）

1. **WORKTREE_PATH変数**: パス生成ロジックの変更
2. **説明文**: 「親ディレクトリ」→「サブディレクトリ」への文言変更
3. **コマンド例**: 全ての`git worktree add`コマンドのパス引数変更
4. **ディレクトリ構成図**: 推奨構成の図を更新
5. **エラー時の手動コマンド**: 正しいパスに更新

### .gitignore

- `.worktree/` は別ブランチのworktreeであるため、gitの追跡対象外
- .gitignore への追加は不要

## 実装ステップ

### Phase 1: 設計

1. ドメインモデル設計（変更箇所の整理）
2. 論理設計（具体的な変更内容の定義）
3. 設計レビュー

### Phase 2: 実装

1. setup.mdの変更
2. ai-agent-allowlist.mdの確認・必要に応じて変更
3. 動作確認（ドキュメント整合性チェック）
4. AIレビュー
5. コミット

## リスク・注意事項

- 既存worktreeがある場合の移行は手動対応（ドキュメントに記載済み）
- プロジェクト内に`.worktree/`ディレクトリが作成されるが、gitの仕様上追跡対象外

## 関連Issue

- #59

---

作成日: 2026-01-18 11:43:00 JST
