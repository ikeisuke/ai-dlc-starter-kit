# 実装記録: Unit 3 表記揺れ対策

## 実装日時
2025-11-28 開始 〜 2025-11-28 完了

## 修正ファイル

### プロンプト修正
- `prompts/setup/common.md` - 変数置換ルール追加（変数一覧、禁止事項）
- `prompts/setup-prompt.md` - 表記揺れ防止ルール追加（冒頭）

### 設計ドキュメント
- `docs/cycles/v1.0.1/plans/unit3_notation_consistency_plan.md`

## 実装内容

### 1. 変数置換ルールの明示（common.md）

以下を追加：
- 表記揺れ防止の原則（4項目）
- 置換対象の変数一覧（15変数）
- 禁止事項（4項目）

### 2. セットアッププロンプトへの追記（setup-prompt.md）

冒頭に「表記揺れ防止ルール【最重要】」セクションを追加：
- テンプレートをそのままコピー
- 変数のみ置換
- 文章の修正・改善は禁止

## ビルド結果
N/A（ドキュメント・プロンプトのみ）

## テスト結果
N/A（ドキュメント・プロンプトのみ）

## コードレビュー結果
- [x] セキュリティ: OK
- [x] コーディング規約: OK
- [x] ドキュメント: OK

## 技術的な決定事項

1. **静的化ではなくルール明示を採用**: 完全な静的化はプロジェクト固有情報の反映を妨げるため、変数置換のみを許可するルールを明示
2. **当初計画のオプション不採用**:
   - ハッシュ管理 → 実装コストが高い
   - 差分ツールカスタマイズ → 完全な解決にならない
3. **シンプルな解決策**: AIに「変更するな」と明示的に指示することで表記揺れを防止

## 課題・改善点

- 実際にセットアップを実行してルールが守られるか検証が必要
- ルール違反があった場合の検出方法は未実装（将来課題）

## 状態
**完了**

## 備考
当初計画（8時間）から大幅に簡略化（1.5時間 → 実際は約30分）。
シンプルな「ルール明示」で解決。
