# Unit 1: セットアップバグ修正 - 実装計画

## 概要
AI-DLC Starter Kit v1.0.0で発見されたセットアップ時のバグ2件を修正し、セットアップの信頼性を向上させる。

## 対象ユーザーストーリー
- ストーリー 1.1: セットアップ時のディレクトリ作成バグ修正
- ストーリー 1.2: 日付コマンド展開問題の検証と修正

## Phase 1: 設計（対話形式）

### ステップ1: ドメインモデル設計
**成果物**: `docs/cycles/v1.0.1/design-artifacts/domain-models/unit1_setup_bugfix_domain_model.md`

**内容**:
- このUnitは「プロンプトファイル修正」という性質上、ビジネスロジックを持つドメインモデルは存在しない
- 代わりに、以下の「修正対象」と「修正内容」を設計として記述：
  - セットアッププロンプトのディレクトリ作成リスト
  - 各フェーズプロンプトの履歴記録指示
  - 日付取得方法の標準化

**対話内容**:
- プロンプトファイルの修正箇所と修正内容を明確化
- 既存の実装（履歴ファイル等）を確認し、問題点を洗い出す

### ステップ2: 論理設計
**成果物**: `docs/cycles/v1.0.1/design-artifacts/logical-designs/unit1_setup_bugfix_logical_design.md`

**内容**:
- 修正対象ファイルのリスト
- 各ファイルの修正箇所と修正方針
- 日付取得の統一方法（`TIMESTAMP=$(date '+%Y-%m-%d %H:%M:%S')` を推奨）
- テスト方法（セットアップ実行、履歴記録確認）

### ステップ3: 設計レビュー
ユーザーに設計内容を提示し、承認を得る。

## Phase 2: 実装

### ステップ4: コード生成
**対象ファイル**:
1. `prompts/setup-prompt.md`
   - ディレクトリ作成リストに `inception/` を追加
   - 履歴記録の日付取得方法を明記

2. `docs/aidlc/prompts/inception.md`
   - 履歴記録の日付取得方法を明記

3. `docs/aidlc/prompts/construction.md`
   - 履歴記録の日付取得方法を明記

4. `docs/aidlc/prompts/operations.md`
   - 履歴記録の日付取得方法を明記（存在する場合）

### ステップ5: テスト生成
**テストアプローチ**:
- セットアップの実行テスト（手動）
  - 新しいサイクルでセットアップを実行
  - `inception/` ディレクトリが作成されることを確認
- 履歴記録のテスト（手動）
  - 各フェーズで履歴を記録
  - 日付が正しく展開されていることを確認

**テスト記録**:
- テスト項目と結果を実装記録に記載

### ステップ6: 統合とレビュー
- 修正内容の確認
- テスト結果の確認
- 実装記録の作成: `docs/cycles/v1.0.1/construction/units/unit1_setup_bugfix_implementation.md`

## 完了基準
- [ ] `prompts/setup-prompt.md` に `inception/` ディレクトリ作成が追加されている
- [ ] 各フェーズプロンプトに日付取得方法が明記されている
- [ ] セットアップ実行時に `inception/` ディレクトリが作成される（テストで確認）
- [ ] 履歴記録時に日付が正しく展開される（テストで確認）
- [ ] 実装記録に「完了」が明記されている
- [ ] `progress.md` が更新されている
- [ ] 履歴ファイル（`history.md`）に記録されている
- [ ] Gitコミットが作成されている

## 見積もり
- Phase 1（設計）: 0.5時間
- Phase 2（実装）: 1時間
- テスト: 0.5時間
- 合計: 2時間

## 備考
- このUnitはドメインロジックを持たないため、ドメインモデル設計は「修正対象と修正内容の整理」として扱う
- テストは手動テストが中心（プロンプトファイルの修正のため）
