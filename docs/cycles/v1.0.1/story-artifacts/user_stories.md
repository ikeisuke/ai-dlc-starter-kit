# ユーザーストーリー

## Epic 1: バグ修正

### ストーリー 1.1: セットアップ時のディレクトリ作成バグ修正
**優先順位**: Must-have

As a AI-DLC Starter Kitの利用者
I want to セットアップ時に必要な全てのディレクトリが自動的に作成される
So that 各フェーズの実行時にディレクトリ作成エラーが発生せず、スムーズに開発を進められる

**受け入れ基準**:
- [ ] `prompts/setup-prompt.md` のディレクトリ作成リストに `inception/` が含まれている
- [ ] セットアップ実行時に `docs/cycles/{CYCLE}/inception/` ディレクトリが作成される
- [ ] セットアップ後、全ての必要なディレクトリが存在することを確認できる
- [ ] 既存のセットアップ手順に影響を与えない

**技術的考慮事項**:
- `mkdir -p` コマンドを使用してディレクトリを作成
- `.gitkeep` ファイルを配置してGit管理対象にする

---

### ストーリー 1.2: 日付コマンド展開問題の検証と修正
**優先順位**: Should-have

As a AI-DLC Starter Kitの利用者
I want to 履歴記録時に日付が正しく展開されて記録される
So that 実行履歴を後から見たときに、正確な実行日時を確認できる

**受け入れ基準**:
- [ ] 既存の `history.md` の日時記録が正しいことを確認
- [ ] heredoc内での `date` コマンド使用方法が正しいことを検証
- [ ] 各フェーズプロンプトの履歴記録指示が明確である
- [ ] セットアップ、Inception、Construction、Operations の各フェーズで日時が正しく記録される

**技術的考慮事項**:
- heredocのクォート（シングル/ダブル）の使い分けを明確化
- 事前に `TIMESTAMP=$(date '+%Y-%m-%d %H:%M:%S')` で取得する方法を推奨
- プロンプトファイルに具体的な実装例を記載

---

## Epic 2: スターターキットのバージョンアップ対応

### ストーリー 2.1: バージョンアップ検知の仕組み構築
**優先順位**: Must-have

As a AI-DLC Starter Kitを利用しているプロジェクトの開発者
I want to スターターキットの新バージョンがリリースされたことを検知できる
So that 最新の改善や機能を利用できるタイミングを逃さない

**受け入れ基準**:
- [ ] 現在のバージョン（`docs/aidlc/version.txt`）とリモートの最新バージョンを比較する仕組みがある
- [ ] バージョンチェックの実行方法が文書化されている
- [ ] 新バージョンが利用可能な場合、差分の概要を確認できる
- [ ] バージョンチェックはオプトイン（任意実行）である

**技術的考慮事項**:
- GitHub APIを使用してリモートリポジトリのバージョンを取得
- または、特定のURLから version.txt を取得
- Bashスクリプトまたは軽量なプログラムで実装

---

### ストーリー 2.2: バージョンアップ手順の文書化
**優先順位**: Must-have

As a AI-DLC Starter Kitを利用しているプロジェクトの開発者
I want to 新バージョンへのアップグレード手順が明確に文書化されている
So that 認知負荷を最小限に抑えて、安全にバージョンアップできる

**受け入れ基準**:
- [ ] バージョンアップ手順書が作成されている（`docs/aidlc/upgrade-guide.md`など）
- [ ] 手順書には以下が含まれる：
  - [ ] バージョン間の主要な変更点の確認方法
  - [ ] ファイル単位での差分適用手順
  - [ ] バックアップとロールバック手順
  - [ ] 既存のサイクルへの影響評価方法
- [ ] 手順が実際に実行可能であることを検証済み

**技術的考慮事項**:
- セマンティックバージョニングの採用を検討
- メジャー/マイナー/パッチバージョンごとの対応方針

---

### ストーリー 2.3: 表記揺れ問題の解決
**優先順位**: Should-have

As a AI-DLC Starter Kitのメンテナー
I want to テンプレートやプロンプトの動的生成による表記揺れを防ぐ
So that バージョン間の差分が明確になり、変更管理が容易になる

**受け入れ基準**:
- [ ] 表記揺れの原因が特定されている
- [ ] 解決策が選定されている（静的化、ハッシュ管理、等）
- [ ] 選定した解決策の設計が完了している
- [ ] 実装方針が文書化されている

**技術的考慮事項**:
- オプション1: 動的生成をやめ、静的なテンプレートを配布
- オプション2: ファイルのハッシュ値を管理し、内容の同一性を判定
- オプション3: 差分ツールのカスタマイズ（空白・改行を無視）

---

## Epic 3: サイクル間のタスク引き継ぎ管理

### ストーリー 3.1: 次サイクルへのタスクリスト管理仕組みの設計
**優先順位**: Must-have

As a AI-DLC Starter Kitの利用者
I want to 各サイクルのOperations Phase完了時に生成されるタスクが明確に管理される
So that 次のサイクルで何を実施すべきかを迷わずに判断できる

**受け入れ基準**:
- [ ] タスクリストの記録場所が定義されている（例: `docs/cycles/{CYCLE}/operations/next_cycle_tasks.md`）
- [ ] タスクリストのフォーマットが定義されている
- [ ] 複数サイクルのタスクを集約して確認する方法が文書化されている
- [ ] Operations Phaseプロンプトにタスクリスト作成の指示が追加されている

**技術的考慮事項**:
- 集約方法の候補：
  - 全サイクルのタスクを一覧表示するスクリプト
  - 最新サイクルのタスクを優先的に表示する仕組み
  - タスクに優先度とステータスを付与

---

### ストーリー 3.2: サイクル横断タスク管理の実装
**優先順位**: Should-have

As a AI-DLC Starter Kitの利用者
I want to どのサイクルの何を見ればいいかが一目でわかる
So that タスクの見落としを防ぎ、効率的にプロジェクトを進められる

**受け入れ基準**:
- [ ] サイクル横断でタスクを集約・表示する仕組みが実装されている
- [ ] 実装方法（Bashスクリプト、Markdown集約、等）が決定している
- [ ] 実装が完了し、動作確認が済んでいる
- [ ] 使用方法が文書化されている

**技術的考慮事項**:
- 実装候補：
  - Bashスクリプトで全サイクルのタスクファイルを読み込み、集約表示
  - サマリーファイル（`docs/cycles/task_summary.md`）を自動生成
  - 優先度やステータスでフィルタリング可能にする

---

## Epic 4: AI-DLCサイクル全体へのIssue駆動開発の統合

### ストーリー 4.1: Issue駆動開発統合の検討と設計
**優先順位**: Should-have

As a AI-DLC Starter Kitの利用者
I want to GitHubやGitLabのIssue管理とAI-DLCサイクルがシームレスに連携する
So that タスク管理が一元化され、開発効率が向上する

**受け入れ基準**:
- [ ] Issue駆動開発の統合方法が検討されている
- [ ] Inception、Construction、Operationsの各フェーズでのIssue活用方法が設計されている
- [ ] Issue → Unit → 実装 → クローズのフローが定義されている
- [ ] 設計文書が作成されている（`docs/cycles/v1.0.1/design-artifacts/architecture/issue_driven_integration.md`）

**技術的考慮事項**:
- Issueテンプレートの設計（Epic用、Unit用、バグ用、等）
- Issueのラベルやマイルストーンとサイクルの対応付け
- 自動化の可能性（Issue作成、ステータス更新、等）

---

### ストーリー 4.2: Issue駆動開発統合の実装方針決定
**優先順位**: Could-have

As a AI-DLC Starter Kitのメンテナー
I want to Issue駆動開発統合の実装方針が明確になっている
So that 次サイクル以降で実装を進めることができる

**受け入れ基準**:
- [ ] 実装の優先順位が決定している
- [ ] 実装範囲が明確になっている（どこまで自動化するか、等）
- [ ] 次サイクル以降の実装計画が立てられている
- [ ] 実装に必要な技術要素が洗い出されている

**技術的考慮事項**:
- GitHub Actions / GitLab CIとの連携
- API経由でのIssue操作
- プロンプトファイルへの統合方法

---

## Epic 5: Operations Phaseでのテストとバグ対応

### ストーリー 5.1: テスト記録フォーマットの提供
**優先順位**: Must-have

As a AI-DLC Starter Kitの利用者
I want to Operations Phaseでのテスト実施時に使用する記録フォーマット（型）がある
So that テスト結果を一貫した形式で記録でき、後から確認しやすくなる

**受け入れ基準**:
- [ ] テスト記録テンプレートが作成されている（`docs/aidlc/templates/test_record_template.md`）
- [ ] テンプレートには以下が含まれる：
  - [ ] テスト項目リスト
  - [ ] テスト結果（成功/失敗）
  - [ ] バグ発見時の記録欄
  - [ ] 再現手順
  - [ ] 期待結果と実際の結果
- [ ] Operations Phaseプロンプトにテスト記録の指示が追加されている

**技術的考慮事項**:
- Markdown形式で記録
- チェックリスト形式で進捗を可視化

---

### ストーリー 5.2: バグ対応フローの文書化
**優先順位**: Must-have

As a AI-DLC Starter Kitの利用者
I want to バグ発見時にどのフェーズに戻るべきか、どう修正するかが明確になっている
So that バグ対応で迷わず、適切なフローで修正できる

**受け入れ基準**:
- [ ] バグ対応フロー文書が作成されている（`docs/aidlc/bug-response-flow.md`）
- [ ] フローには以下が含まれる：
  - [ ] バグの種類別の対応フロー（設計バグ、実装バグ、環境バグ）
  - [ ] どのフェーズに戻るかの判断基準
  - [ ] バグ修正の記録方法
  - [ ] 再テストの手順
- [ ] 各フェーズプロンプトのバックトラックセクションと整合性がある

**技術的考慮事項**:
- フローチャートまたは判断木を使用
- Construction Phase、Operations Phaseのバックトラック手順との連携

---

## Epic 6: 既存プロンプトの活用徹底

### ストーリー 6.1: プロンプト参照ガイドの作成
**優先順位**: Should-have

As a AI-DLC Starter Kitの利用者
I want to 既存のフェーズプロンプトを活用する方法が明確になっている
So that 独自プロンプトを作らず、一貫性のある開発を進められる

**受け入れ基準**:
- [ ] プロンプト参照ガイドが作成されている（`docs/aidlc/prompt-reference-guide.md`）
- [ ] ガイドには以下が含まれる：
  - [ ] 各フェーズプロンプトの使い方
  - [ ] フェーズ間の移行方法
  - [ ] よくある間違い（独自プロンプト作成など）
  - [ ] プロンプトのカスタマイズ方法（additional-rules.md の活用）
- [ ] セットアップ完了メッセージにガイド参照の案内が追加されている

**技術的考慮事項**:
- 実行例を豊富に含める
- コマンド形式で記載（コピー＆ペースト可能に）

---

### ストーリー 6.2: 独自プロンプト防止の仕組み
**優先順位**: Could-have

As a AI-DLC Starter Kitのメンテナー
I want to ユーザーが誤って独自プロンプトを作成することを防ぐ仕組みがある
So that フェーズ間の一貫性が保たれ、混乱が減少する

**受け入れ基準**:
- [ ] 独自プロンプト検出スクリプトが作成されている（オプション）
- [ ] または、各フェーズプロンプトに「独自プロンプトを作成しないでください」という注意書きが追加されている
- [ ] プロンプト参照ガイドに防止策が記載されている

**技術的考慮事項**:
- シンプルな注意書きから始め、必要に応じて自動化を検討

---

## ストーリーマップ

### Phase 1: バグ修正（優先度: 最高）
- ストーリー 1.1: ディレクトリ作成バグ修正
- ストーリー 1.2: 日付展開問題の検証と修正

### Phase 2: バージョンアップ対応（優先度: 高）
- ストーリー 2.1: バージョンアップ検知
- ストーリー 2.2: バージョンアップ手順文書化
- ストーリー 2.3: 表記揺れ問題解決

### Phase 3: サイクル管理（優先度: 高）
- ストーリー 3.1: タスクリスト管理設計
- ストーリー 3.2: サイクル横断タスク管理実装

### Phase 4: Issue駆動開発統合（優先度: 中）
- ストーリー 4.1: Issue駆動開発統合の検討と設計
- ストーリー 4.2: Issue駆動開発統合の実装方針決定

### Phase 5: テストとバグ対応（優先度: 最高）
- ストーリー 5.1: テスト記録フォーマットの提供
- ストーリー 5.2: バグ対応フローの文書化

### Phase 6: プロンプト活用徹底（優先度: 中）
- ストーリー 6.1: プロンプト参照ガイドの作成
- ストーリー 6.2: 独自プロンプト防止の仕組み

---

## 備考
- 全14ストーリー（4ストーリー追加）
- Must-have: 7ストーリー
- Should-have: 5ストーリー
- Could-have: 2ストーリー
- 次のステップでUnitに分解する際は、依存関係を明確にする
