# ユーザーストーリー

## Epic 1: 基盤整備

### ストーリー 1.1: パス参照不整合の修正
**優先順位**: Should-have

As a AI-DLCを使用する開発者
I want to construction.mdのUnit定義ファイルパスが実際の構造と一致すること
So that AIがUnit定義ファイルを即座に見つけられる

**受け入れ基準**:
- [ ] construction.md内のパス参照が `story-artifacts/units/` を指している
- [ ] AIがUnit定義を探索なしで読み込める

**技術的考慮事項**:
- `docs/aidlc/prompts/construction.md` の修正
- `prompts/setup/construction.md` テンプレートの修正

---

### ストーリー 1.2: 変数の具体例を削除
**優先順位**: Must-have

As a AI-DLCを使用する開発者
I want to セットアップテンプレート内の変数に具体例（v1.0.1等）がないこと
So that AIが誤ったデフォルト値を使用しない

**受け入れ基準**:
- [ ] `prompts/setup/common.md` の変数一覧から具体例を削除
- [ ] 変数名のみで意味が伝わる形式に統一

**技術的考慮事項**:
- 変数名自体が説明的なので例は不要
- `{{CYCLE}}` → サイクル識別子（例の列は空または削除）

---

## Epic 2: CI/CD自動化

### ストーリー 2.1: マージ後のタグ付け自動化
**優先順位**: Should-have

As a AI-DLCを使用する開発者
I want to mainブランチへのマージ時に自動でGitタグが作成されること
So that タグ付け忘れを防止しリリース作業を自動化できる

**受け入れ基準**:
- [ ] GitHub Actionsワークフローが作成されている
- [ ] mainマージ時に `docs/aidlc/version.txt` を読んでタグを作成
- [ ] 既存タグがある場合はスキップ

**技術的考慮事項**:
- `.github/workflows/auto-tag.yml` を新規作成
- version.txt のフォーマット: `X.Y.Z`
- タグ形式: `vX.Y.Z`

---

## Epic 3: バージョン管理

### ストーリー 3.1: プロンプト/テンプレートのバージョン埋め込み
**優先順位**: Should-have

As a AI-DLCを使用する開発者
I want to プロンプトとテンプレートにバージョン情報が埋め込まれていること
So that 更新の要否を判断できる

**受け入れ基準**:
- [ ] プロンプト/テンプレートの1行目にバージョンコメントがある
- [ ] 形式: `<!-- AI-DLC Toolkit vX.Y.Z -->`
- [ ] セットアップ時にバージョン比較が可能

**技術的考慮事項**:
- `prompts/setup/*.md` テンプレート側の修正
- 生成される `docs/aidlc/**/*.md` への反映
- バージョンがない場合は v1.2.0 以前と判断可能

---

## Epic 4: セットアップ改善

### ストーリー 4.1: セットアップ処理の分離
**優先順位**: Could-have

As a AI-DLCを使用する開発者
I want to 初回セットアップとサイクルセットアップが分離されていること
So that サイクル開始時の作業が軽減される

**受け入れ基準**:
- [ ] 初回セットアップ: ベースプロンプト・テンプレート生成
- [ ] サイクルセットアップ: サイクルディレクトリ作成のみ
- [ ] 既存プロジェクトでは初回セットアップをスキップ可能

**技術的考慮事項**:
- `prompts/setup-prompt.md` の分割または条件分岐
- バージョン確認ロジックの活用

---

### ストーリー 4.2: プロンプト生成方式の改善
**優先順位**: Could-have

As a AI-DLCを使用する開発者
I want to 出力用プロンプトが個別ファイルとして管理されていること
So that メンテナンスが容易になる

**受け入れ基準**:
- [ ] テンプレートがセットアップファイルから分離されている
- [ ] 変数置換のみで生成が完了する
- [ ] 差分確認が容易

**技術的考慮事項**:
- `prompts/templates/` にテンプレートファイルを配置
- セットアップ処理は変数置換とコピーのみに簡略化

---

## Epic 5: プロンプト最適化

### ストーリー 5.1: プロンプトの分割・短縮化
**優先順位**: Must-have

As a AI-DLCを使用する開発者
I want to フェーズプロンプトが小さいファイルに分割されていること
So that AIが確実にプロンプト内容を読むようになる

**受け入れ基準**:
- [ ] 各フェーズプロンプトが init / flow / complete 等に分割
- [ ] ステップごとに必要最小限の情報のみ渡される
- [ ] 読み込み確認機構がある（オプション）

**技術的考慮事項**:
- 現在の大きなプロンプトを複数ファイルに分割
- 分割粒度: 初期化 / フロー / 完了処理
- Claude Code以外のAIツールでも安定動作

---

## ストーリー優先順位まとめ

| 優先順位 | ストーリー |
|---------|-----------|
| Must-have | 1.2（変数削除）, 5.1（プロンプト分割） |
| Should-have | 1.1（パス修正）, 2.1（タグ自動化）, 3.1（バージョン埋め込み） |
| Could-have | 4.1（セットアップ分離）, 4.2（生成方式改善） |
