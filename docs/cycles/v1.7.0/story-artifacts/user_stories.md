# ユーザーストーリー

## Epic 1: AIエージェント連携強化

### ストーリー 1-1: AIエージェント許可リストガイドの提供
**優先順位**: Should-have

As an AI-DLCを使用する開発者
I want to 各AIエージェント向けの安全なコマンド許可リストを参照できる
So that 確認ダイアログを減らしてスムーズに開発を進められる

**受け入れ基準**:
- [ ] `prompts/package/guides/ai-agent-allowlist.md` が作成されている
- [ ] Claude Code、Cursor、Cline、Aider向けの設定方法が記載されている
- [ ] 読み取り専用、作成系、Git操作のカテゴリ別にコマンドが分類されている（各カテゴリ5件以上）
- [ ] 除外すべき破壊的コマンドが明示されている（`git push --force`, `rm -rf` 等を含む）
- [ ] スターターキットセットアップ完了時にこのガイドへの導線が案内される

**技術的考慮事項**:
- 各AIエージェントの設定ファイル形式は異なるため、設定ファイルパスと設定方法を記載

---

## Epic 2: GitHub Issues連携（バックログ管理）

### ストーリー 2-1: バックログ用Issueテンプレートの整備
**優先順位**: Should-have

As an AI-DLCを使用するチーム開発者
I want to バックログ項目をGitHub Issueとして管理できる
So that バックログの進捗をGitHub上で可視化し、チーム全体で共有できる

**受け入れ基準**:
- [ ] `.github/ISSUE_TEMPLATE/` ディレクトリが作成されている
- [ ] バックログ用テンプレート（`backlog.md`）が作成されている
- [ ] バグ報告用テンプレート（`bug.md`）が作成されている
- [ ] 機能要望用テンプレート（`feature.md`）が作成されている

**技術的考慮事項**:
- GitHub CLIが未認証の環境でもスキップ可能とする
- テンプレートはAI-DLCスターターキットに含まれ、スターターキットセットアップ時にコピーされる
- サイクル・フェーズ管理は従来通りローカルファイルで行う（将来的にIssue連携を検討）

---

### ストーリー 2-2: Issue駆動バックログフロー定義
**優先順位**: Could-have

As an AI-DLCを使用するプロジェクトマネージャー
I want to バックログとIssueの連携フローを把握できる
So that Issue駆動でバックログ管理をAI-DLCに統合できる

**受け入れ基準**:
- [ ] Issue駆動バックログフローのドキュメント（`prompts/package/guides/issue-driven-backlog.md`）が作成されている
- [ ] 新規バックログ作成時のIssue作成フローが定義されている
- [ ] バックログ対応完了時のIssueクローズフローが定義されている
- [ ] ローカルの `docs/cycles/backlog/` との併用方法が説明されている
- [ ] `docs/aidlc.toml` にバックログ管理方式の設定項目（`[backlog].mode`）が追加されている

**技術的考慮事項**:
- GitHub CLIが認証済みであること、リポジトリへの書き込み権限があることを前提とする（Issue保存の場合）
- 未認証の場合は `git` モードにフォールバック
- サイクル・フェーズ管理へのIssue連携は将来検討事項として記載
- バックログ管理方式は「保存先」の選択（`issue` / `git`）。参照は両方を見る

---

## Epic 3: バージョン管理システム拡張

### ストーリー 3-1: jj基本ワークフローの文書化
**優先順位**: Could-have

As a jjに興味を持つ先進的な開発者
I want to AI-DLCでjjを使用する方法を把握できる
So that 最新のバージョン管理ワークフローを採用できる

**受け入れ基準**:
- [ ] `prompts/package/guides/jj-support.md` が作成されている
- [ ] jjの特徴と利点が5項目以上列挙されている
- [ ] Git/jj両対応のコマンド対照表が10件以上含まれている（status, commit, branch等の基本操作）
- [ ] AI-DLCワークフローとの互換性が具体的なシナリオで説明されている（サイクル開始、コミット、ブランチ切り替え等）

**技術的考慮事項**:
- 実験的機能として位置づけ、オプトインで利用可能
- Gitとの共存を前提とする

---

## Epic 4: メンテナンス性向上

### ストーリー 4-1: セットアッププロンプトパスの記録
**優先順位**: Should-have

As an AI-DLCをアップグレードする開発者
I want to 以前使用したスターターキットセットアッププロンプトのパスを確認できる
So that アップグレード時に正しいプロンプトを使用できる

**受け入れ基準**:
- [ ] スターターキットセットアップ時に使用したパスが `docs/aidlc.toml` の `[setup].prompt_path` に記録される
- [ ] Operations Phase完了時のメッセージで `[setup].prompt_path` の値が参照・表示される

**技術的考慮事項**:
- `[setup]` セクションを `aidlc.toml` に追加
- `prompts/setup-prompt.md`（スターターキットセットアップ）で動的にパスを記録する処理を追加
- サイクルセットアップ（`docs/aidlc/prompts/setup.md`）とは別物であることに注意

---

### ストーリー 4-2: 旧形式バックログ移行時のバックアップ処理削除
**優先順位**: Must-have

As an AI-DLCの開発者
I want to 不要なバックアップファイルが作成されないようにしたい
So that gitで管理しているリポジトリをクリーンに保てる

**受け入れ基準**:
- [ ] `prompts/package/prompts/setup.md`（サイクルセットアップ）からバックアップ作成ステップ（`cp ... .bak`）が削除されている
- [ ] 終了メッセージから「バックアップ」「.bak」関連の文言が削除されている
- [ ] 移行成功時に旧ファイル（`docs/cycles/backlog.md`）が直接削除される

**技術的考慮事項**:
- gitで履歴が残るため、バックアップファイルは不要

---

## 用語の区別

| 用語 | 説明 | 対象ファイル |
|------|------|-------------|
| スターターキットセットアップ | AI-DLCスターターキットの初期導入・アップグレード | `prompts/setup-prompt.md` |
| サイクルセットアップ | 新規サイクルの開始 | `docs/aidlc/prompts/setup.md` |
