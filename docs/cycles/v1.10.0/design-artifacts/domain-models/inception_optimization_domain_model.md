# ドメインモデル: inception.mdサイズ最適化

## 概要

inception.mdのファイルサイズを最適化するため、コンテンツの構造を分析し、外部化対象を特定する。

**重要**: このドメインモデル設計では**コードは書かず**、構造と責務の定義のみを行います。

## 現状分析

### inception.mdの構造（812行）

| セクション | 行範囲 | 行数 | 外部化候補 |
|-----------|--------|------|-----------|
| ヘッダー・プロジェクト情報 | 1-117 | 117 | - |
| 最初に必ず実行すること | 125-371 | 246 | 部分的 |
| - ステップ0-3.3（環境確認まで） | 125-239 | 114 | - |
| - ステップ3.5（セットアップコンテキスト確認） | 240-371 | 132 | 検討 |
| ステップ4-6（PR/Issue/バックログ確認） | 372-486 | 115 | 部分的 |
| ステップ7-8（進捗・成果物確認） | 487-510 | 23 | - |
| フロー（ステップ1-5） | 511-598 | 88 | - |
| 実行ルール・完了基準 | 599-648 | 50 | - |
| 完了時の必須作業（iOSバージョン更新含む） | 616-703 | 88 | **対象** |
| - iOSバージョン更新 | 649-703 | 55 | **外部化** |
| ドラフトPR作成・Git・次のステップ | 704-789 | 86 | - |
| バックトラック | 790-812 | 23 | - |

## 外部化対象の特定

### 1. iOSバージョン更新セクション（55行）

**現状**: inception.mdの649-703行に詳細な手順が記載

**外部化理由**:
- iOSプロジェクト専用の機能（project.type=ios以外では不要）
- 詳細な手順書であり、参照形式で十分
- 削減効果: 約50行

**外部化先**: `prompts/package/guides/ios-version-update.md`

### 2. Dependabot PR確認・GitHub Issue確認のbashコマンド

**現状**: ステップ4-5にインラインでコマンドが記載

**ヘルパースクリプト化理由**:
- 複数のプロンプトファイルで類似コマンドが使用される可能性
- エラーハンドリングの一元化
- 削減効果: 約10行

**外部化先**:
- `prompts/package/bin/check-dependabot-prs.sh`
- `prompts/package/bin/check-open-issues.sh`

### 3. 冗長な説明の簡略化

**対象候補**:
- セットアップコンテキスト確認の詳細ロジック（290-340行、約50行）

**検討結果**:
- 重複質問回避ロジックはAIが正しく動作するために必要
- 完全な外部化は機能に影響する可能性
- 代替案: 説明の簡略化（表形式への変換等）で約20行削減

## エンティティ（ファイル構造）

### InceptionPrompt

- **パス**: `prompts/package/prompts/inception.md`
- **責務**: Inception Phaseの全体フローを定義
- **依存**: 外部ガイド、ヘルパースクリプト

### ExternalGuide

- **パス**: `prompts/package/guides/*.md`
- **責務**: 詳細な手順書を提供
- **属性**:
  - ios-version-update.md: iOSバージョン更新手順

### HelperScript

- **パス**: `prompts/package/bin/*.sh`
- **責務**: 繰り返し使用されるコマンドを一元化
- **属性**:
  - check-dependabot-prs.sh: Dependabot PR一覧取得
  - check-open-issues.sh: オープンIssue一覧取得

## 依存関係

```
inception.md
├── 参照 → guides/ios-version-update.md
├── 呼び出し → bin/check-dependabot-prs.sh
└── 呼び出し → bin/check-open-issues.sh
```

## 削減見積もり

| 対象 | 削減行数 | 備考 |
|------|---------|------|
| iOSバージョン更新外部化 | 約50行 | 参照形式に置換 |
| ヘルパースクリプト化 | 約10行 | コマンドを1行呼び出しに |
| 説明の簡略化 | 約25行 | 表形式変換等 |
| **合計** | **約85行** | 目標82行以上達成見込み |

## 不明点と質問（設計中に記録）

[Question] セットアップコンテキスト確認の詳細ロジック（290-340行）を外部化すべきか？
[Answer] 機能に影響する可能性があるため、説明の簡略化のみで対応する（完全外部化は見送り）
