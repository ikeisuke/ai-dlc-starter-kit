# 論理設計: バックログ登録時の不明点確認フロー

## 概要

バックログ登録時の確認フローをガイドドキュメントとして定義し、既存のバックログ管理ガイドから参照する。

**重要**: この論理設計では**コードは書かず**、コンポーネント構成とインターフェース定義のみを行います。具体的なコード（SQL、JSON、実装コード等）はImplementation Phase（コード生成ステップ）で作成します。

## アーキテクチャパターン

ドキュメント参照パターン - 既存ガイドから新規ガイドを参照し、関心事を分離する

## コンポーネント構成

### ファイル構成

```text
prompts/package/guides/
├── backlog-management.md     (既存 - 参照追加)
└── backlog-registration.md   (新規 - 確認フロー定義)
```

### コンポーネント詳細

#### backlog-registration.md（新規）

- **責務**: バックログ登録時の確認フロー、必須項目、AskUserQuestion活用パターンを定義
- **依存**: なし
- **公開インターフェース**:
  - 確認フローのトリガー条件
  - 質問テンプレート
  - 必須項目一覧

#### backlog-management.md（更新）

- **責務**: バックログ管理全般のガイド（モード、保存先、フロー）
- **依存**: backlog-registration.md への参照追加
- **公開インターフェース**: 変更なし

## インターフェース設計

### 確認フロー（AskUserQuestion活用）

#### 質問1: 概要（必須）

- **質問内容**: 「概要を教えてください（何をしたいか、1-2文で）」
- **期待する回答**: 1-2文の簡潔な説明
- **バリデーション**: 空でないこと

#### 質問2: 背景（必須）

- **質問内容**: 「背景を教えてください（なぜ必要か、発見した経緯）」
- **期待する回答**: 必要性や発見経緯の説明
- **バリデーション**: 空でないこと

#### 質問3: 期待する結果（必須）

- **質問内容**: 「期待する結果を教えてください（完了時にどうなっていれば良いか）」
- **期待する回答**: 受け入れ基準・完了条件
- **バリデーション**: 空でないこと

#### 質問4: 優先度（任意）

- **質問内容**: 「優先度を選択してください」
- **選択肢**: High / Medium / Low
- **デフォルト**: Medium

## 処理フロー概要

### バックログ登録確認フロー

**トリガー条件**:
- ユーザーが「バックログに追加して」「backlogに登録して」等の発言をした場合
- Construction Phase で作業中に発見した課題を記録する場合（ユーザー起点のみ）

**ステップ**:
1. トリガー検出 - ユーザーからのバックログ登録要求を検出
2. 確認フロー開始 - 一問一答形式で質問を提示
3. 必須項目の収集 - 概要、背景、期待する結果を収集
4. 任意項目の収集 - 優先度を確認（スキップ可能）
5. 内容確認 - 収集した情報を整理してユーザーに確認
6. バックログ登録 - 確認後、設定されたモード（Issue/Git）で登録

**関与するコンポーネント**: AIアシスタント、AskUserQuestion機能

### 適用範囲の判定

**対象**:
- ユーザーが明示的にバックログ登録を要求した場合

**対象外（既存フローを使用）**:
- AI自動検出による気づき記録（Construction Phase の気づき記録フロー）
- workaround 実施時の自動記録

## 非機能要件（NFR）への対応

### パフォーマンス
- **要件**: 該当なし
- **対応策**: なし

### セキュリティ
- **要件**: 該当なし
- **対応策**: なし

### スケーラビリティ
- **要件**: 該当なし
- **対応策**: なし

### 可用性
- **要件**: 該当なし
- **対応策**: なし

## 技術選定

- **形式**: Markdownドキュメント
- **ツール**: AskUserQuestion機能（Claude Code固有）

## 実装上の注意事項

- メタ開発のため `prompts/package/` を編集（`docs/aidlc/` は直接編集禁止）
- AskUserQuestion の活用はClaude Code固有機能のため、CLAUDE.md で補足説明を追加することを検討
- 一問一答形式を遵守（複数質問を一度に提示しない）

## 不明点と質問（設計中に記録）

なし
