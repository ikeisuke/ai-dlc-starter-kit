# Unit 004: セットアップエントリーポイントの変更 - 計画

## 概要

通常サイクル開始時は `docs/aidlc/prompts/setup.md` を案内し、アップグレード時のみ `prompts/setup-prompt.md` を使用する導線を明確にする。

## 背景

現状の問題:
- operations.md の「次のサイクル開始」セクションで `prompts/setup-prompt.md` を案内している
- `prompts/setup-prompt.md` はアップグレード判定を含むエントリーポイントであり、セットアップ済みプロジェクトでは不要
- セットアップ済みプロジェクトでは `docs/aidlc/prompts/setup.md` を使うべき

## 変更計画

### Phase 1: 設計（ドキュメント修正のため簡略化）

このUnitはドキュメント修正のみのため、ドメインモデル設計・論理設計は省略し、直接変更計画を記載します。

### Phase 2: 実装

#### 変更対象ファイル

1. `prompts/package/prompts/operations.md`

#### 変更内容

**変更1: 冒頭のセットアッププロンプトパスの説明を修正**

現在（3行目）:
```markdown
**セットアッププロンプトパス**: $(ghq root)/github.com/ikeisuke/ai-dlc-starter-kit/prompts/setup-prompt.md
```

変更後:
```markdown
**セットアッププロンプトパス（アップグレード時のみ）**: $(ghq root)/github.com/ikeisuke/ai-dlc-starter-kit/prompts/setup-prompt.md
```

**変更2: 次のサイクル開始セクションの修正（536-556行目付近）**

現在:
```markdown
### 6. 次のサイクル開始【コンテキストリセット必須】

このサイクルが完了しました。以下のメッセージをユーザーに提示してください：

```markdown
---
## サイクル完了

コンテキストをリセットして次のサイクルを開始してください。

**理由**: 長い会話履歴はAIの応答品質を低下させます。新しいセッションで開始することで最適なパフォーマンスを維持できます。

**次のサイクルを開始するプロンプト**（冒頭の「セットアッププロンプトパス」を使用）:
```
以下のファイルを読み込んで、次サイクルの AI-DLC 環境をセットアップしてください：
[セットアッププロンプトパス]
```
---
```
```

変更後:
```markdown
### 6. 次のサイクル開始【コンテキストリセット必須】

このサイクルが完了しました。以下のメッセージをユーザーに提示してください：

```markdown
---
## サイクル完了

コンテキストをリセットして次のサイクルを開始してください。

**理由**: 長い会話履歴はAIの応答品質を低下させます。新しいセッションで開始することで最適なパフォーマンスを維持できます。

**次のサイクルを開始するプロンプト**:
```
以下のファイルを読み込んで、次サイクルの AI-DLC 環境をセットアップしてください：
docs/aidlc/prompts/setup.md
```

**注意**: AI-DLCスターターキットをアップグレードする場合のみ、冒頭の「セットアッププロンプトパス」を使用してください。
---
```
```

## テスト計画

- 変更後のドキュメントが正しい導線を案内していることを目視確認
- rsync後に docs/aidlc/prompts/operations.md に反映されることを確認

## 完了基準

- operations.md が修正されている
- 通常サイクル開始時は `docs/aidlc/prompts/setup.md` を案内する
- アップグレード時の導線が明確に区別されている
