# Unit 004: AIレビュー反復プロセス - 実行計画

## 概要
AIレビュー後の修正→再レビューのループを明文化し、レビュー品質を向上させる。

## 責務
1. construction.mdのAIレビューフローに反復プロセスを追記
2. 「指摘がなくなるまで繰り返す」ことを明記
3. AIレビューのチェックタイミング改善（設計作成後に自動的にレビューフローに入るよう明確化）
4. 設定読み込みパターンの改善（コメント行を誤って読み込む問題の修正）

## Phase 1: 設計

### ステップ1: ドメインモデル設計
- 現状のAIレビューフローの構造を分析
- 反復プロセスのフロー定義
- 設定読み込みパターンの改善案策定

### ステップ2: 論理設計
- 各プロンプトファイルの変更箇所特定
- AWKパターンの標準化
- バリデーションロジックの統一

### ステップ3: 設計レビュー
- 設計内容のレビュー・承認取得

## Phase 2: 実装

### ステップ4: コード生成
対象ファイル:
- `prompts/package/prompts/construction.md` - AIレビューフロー反復プロセス追加
- `prompts/package/prompts/inception.md` - 設定読み込みパターン改善
- `prompts/package/prompts/operations.md` - 設定読み込みパターン改善
- `prompts/package/prompts/setup.md` - 設定読み込みパターン改善

主な変更内容:
- `grep -A1` パターンを `awk` パターンに置換
- コメント行除外ロジック追加
- バリデーションとフォールバック処理の統一
- 反復レビューフローの明文化

### ステップ5: テスト生成
- 設定読み込みパターンの手動テスト（コメント行のあるtoml設定で確認）

### ステップ6: 統合とレビュー
- Markdownlint実行
- AIレビュー（Codex MCP）
- 実装記録作成

## 関連バックログ
- `docs/cycles/backlog/chore-ai-review-iteration.md` - 本Unitで対応

## 見積もり
1.5時間
