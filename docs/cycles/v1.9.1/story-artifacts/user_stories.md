# ユーザーストーリー

## Epic 1: プロンプト最適化

### ストーリー 1: サイクル一覧の正確な取得 (#94)
**優先順位**: Must-have

As a AI-DLC利用者
I want to サイクル一覧取得時にバージョンディレクトリのみが表示される
So that 不要な項目（backlog/, rules.md等）に惑わされずにサイクルを選択できる

**受け入れ基準**:
- [ ] `ls -d docs/cycles/v*/` でバージョンディレクトリのみ取得される
- [ ] backlog/, backlog-completed/, operations.md, rules.md が一覧に含まれない
- [ ] セマンティックバージョン順でソートされる

**技術的考慮事項**:
- setup.md のステップ7.2 を修正

---

### ストーリー 2: 環境確認の重複解消 (#93)
**優先順位**: Should-have

As a AI-DLC利用者
I want to 環境確認が1回で済む
So that 冗長な確認を省略して効率的にセットアップできる

**受け入れ基準**:
- [ ] ステップ1で確認したgh/dasel状態が後続ステップで再利用される
- [ ] 重複するgh auth statusの確認が削除される
- [ ] 運用ルールが明確に文書化される

**技術的考慮事項**:
- setup.md のフロー全体を見直し

---

### ストーリー 3: 確認系処理のスクリプト化 (#97)
**優先順位**: Should-have

As a AI-DLC開発者
I want to setup-prompt.mdの確認系処理がスクリプト化されている
So that プロンプトが簡素化され、許可リスト運用が改善される

**受け入れ基準**:
- [ ] バージョン比較がスクリプト化される（check-version.sh）
- [ ] セットアップ種類判定がスクリプト化される（check-setup-type.sh）
- [ ] setup-prompt.md内のインライン処理が削減される

**技術的考慮事項**:
- 既存スクリプト（check-backlog-mode.sh等）を参考にする
- スクリプト出力形式を統一する

---

### ストーリー 4: プロンプトの圧縮・統合 (#102)
**優先順位**: Could-have

As a AI-DLC利用者
I want to 開始プロンプトが圧縮されている
So that コンテキスト消費が削減され、AIの応答品質が維持される

**受け入れ基準**:
- [ ] AI-DLC手法の要約が共通化される（重複削除）
- [ ] init-cycle-dir.sh でbacklogディレクトリも作成される
- [ ] 冗長な説明が削減される

**技術的考慮事項**:
- 圧縮による情報欠落がないか検証
- 共通部分は common/ に移動

---

## Epic 2: コンテキスト保持

### ストーリー 5: コンパクション時のAIDLC情報保持 (#100)
**優先順位**: Must-have

As a AI-DLC利用者
I want to コンテキストコンパクション後もAIDLC情報が保持される
So that フェーズ・サイクル情報を失わずに作業を継続できる

**受け入れ基準**:
- [ ] 現在のサイクル名がコンパクション後も保持される
- [ ] 現在のフェーズがコンパクション後も保持される
- [ ] 完了済みUnit情報がコンパクション後も保持される
- [ ] CLAUDE.md または AGENTS.md に保持指示が追加される

**技術的考慮事項**:
- Claude Codeのコンパクション仕様を確認
- 保持すべき情報の優先順位を検討

---

## Epic 3: 設定の柔軟性

### ストーリー 6: Co-Authored-By設定の柔軟化 (#92)
**優先順位**: Should-have

As a AI-DLC利用者
I want to Co-Authored-Byの値をaidlc.tomlで設定できる
So that 使用するAIツールに応じた適切なauthor名を設定できる

**受け入れ基準**:
- [ ] aidlc.toml に [rules.commit].ai_author 設定が追加される
- [ ] 各フェーズプロンプトがこの設定を参照する
- [ ] 未設定時はデフォルト値が使用される
- [ ] 任意の文字列が設定可能である

**技術的考慮事項**:
- デフォルト値: `Claude <noreply@anthropic.com>`
- 設定形式: `ai_author = "ツール名 <email>"`

---

## 優先順位サマリー

| 優先度 | ストーリー |
|--------|-----------|
| Must-have | #94 サイクル一覧, #100 コンテキスト保持 |
| Should-have | #93 重複解消, #97 スクリプト化, #92 Co-Authored-By |
| Could-have | #102 プロンプト圧縮 |
