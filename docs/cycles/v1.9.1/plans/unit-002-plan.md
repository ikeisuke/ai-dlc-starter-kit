# Unit 002 計画: 環境確認の重複解消

## 概要

setup.md のステップ1で取得した環境確認結果（gh, dasel, jj, git の状態）を後続ステップで明示的に参照するようフローを統一する。

## 変更対象ファイル

- `prompts/package/prompts/setup.md`（ソース）

**注意**: このプロジェクトはメタ開発のため、`docs/aidlc/prompts/setup.md` は rsync コピーであり直接編集禁止。`prompts/package/prompts/setup.md` を編集する。

## 現状の課題

1. **参照方法の不統一**: ステップ4は「ステップ1で確認した `backlog_mode` を参照する」と明記されているが、ステップ5は「GitHub CLIが利用可能かつ認証済み」とのみ記載
2. **変数名の明示不足**: ステップ1の出力（`gh:available` 等）を後続ステップでどう参照するか明確でない

## 実装計画

### Phase 1: 設計

1. ステップ1の運用ルールを確認し、参照変数名を明確化
2. 後続ステップで参照すべき箇所を特定

### Phase 2: 実装

1. **ステップ5の前提条件を修正**:
   - 「GitHub CLIが利用可能かつ認証済み」を「ステップ1で確認した `gh` ステータスが `available`」に変更
   - 参照方法を統一

2. **他のステップで同様のパターンがあれば修正**:
   - 各ステップを確認し、暗黙的にgh/daselを参照している箇所を明示化

## 完了条件チェックリスト

- [ ] ステップ1の環境確認結果を後続ステップで明示的に参照するフローが実装されている
- [ ] 重複するgh auth statusの確認が削除されている（現状では重複なし→確認のみ）
- [ ] 運用ルールが文書化されている（既存の記載を確認・補強）

## 影響範囲

- setup.md のみ（フロー修正）
- 機能変更なし（既存動作は維持）
