# ドメインモデル: サブエージェント活用ガイド

## 概要

AI-DLCにおけるサブエージェント（Task Tool）の活用パターンを概念的に整理し、効率的な作業委任のガイドラインを定義する。

**重要**: このドメインモデル設計では**コードは書かず**、構造と責務の定義のみを行います。実装はImplementation Phase（コード生成ステップ）で行います。

## 概念モデル

### サブエージェント（Subagent）

Claude CodeのTask Toolで起動される独立したエージェント。

- **特性**:
  - メインエージェントのコンテキストを共有しない
  - 独立したタスクを実行可能
  - 結果をメインエージェントに返却

### 作業カテゴリ

#### 委任可能作業（Delegatable Task）

サブエージェントに委任できる作業。

- **特性**:
  - 独立して完結可能
  - メインエージェントとの対話が不要
  - 明確な完了条件がある
- **例**:
  - バックログファイル/Issue作成
  - Markdownlint実行と自動修正
  - 独立したファイル編集
  - 調査タスク

#### 委任不可作業（Non-Delegatable Task）

メインエージェントで処理すべき作業。

- **特性**:
  - ユーザーとの対話が必要
  - 承認待ちを伴う
  - 複数ファイルの一貫性が求められる
- **例**:
  - 設計レビュー・承認取得
  - MCPレビュー実行
  - ユーザーへの質問
  - 一貫性が必要な複数ファイル編集（依存関係あり）

### 委任可否判断チェックリスト

以下の全てに「はい」なら委任可能:

1. ユーザーへの確認や承認は不要か？
2. 単一ファイルまたは完全に独立した複数ファイルへの作業か？
3. 明確な完了条件があるか？
4. メインエージェントのコンテキストなしで実行可能か？

### 実行パターン

#### 直列実行（Sequential Execution）

推奨パターン。タスクを1つずつ順番に実行。

- **利点**: 編集衝突がない、デバッグしやすい
- **適用**: 同一ファイルへの複数変更

#### 並列実行（Parallel Execution）

注意が必要なパターン。複数タスクを同時実行。

- **利点**: 実行時間の短縮
- **リスク**: ファイル編集の衝突
- **適用**: 完全に独立したタスク（異なるファイル・異なる領域）
- **禁止条件**:
  - 同一ファイルを編集する可能性がある
  - 同一ディレクトリのインデックス（目次等）を更新する
  - 依存関係のあるファイル群を編集する

## ユビキタス言語

このドメインで使用する共通用語：

- **サブエージェント**: Task Toolで起動される独立したAIエージェント
- **メインエージェント**: ユーザーと直接対話しているエージェント
- **委任**: メインエージェントからサブエージェントへの作業割り当て
- **編集衝突**: 複数エージェントが同一ファイルを同時編集することによる問題

## 不明点と質問（設計中に記録）

現時点で不明点なし。
