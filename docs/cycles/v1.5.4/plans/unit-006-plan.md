# Unit 006 計画: バックログ移行重複警告

## 対象Unit

- **Unit名**: バックログ移行重複警告
- **Unit番号**: 006
- **見積もり**: 30分
- **優先度**: Low

## 概要

旧形式バックログ（backlog.md）から新形式（backlog/ディレクトリ）への移行時に、同名タイトルの項目が存在する場合に警告を表示する機能を追加する。

## 現状分析

### 現在の動作

`prompts/package/prompts/setup.md` の「6.2 移行処理」セクションには以下のスキップ条件がある：

```markdown
**スキップ条件**（以下の項目は移行しない）:
- タイトル行（### 見出し）に取消線（~~）が含まれる
- タイトル行に「対応済み」「完了」が含まれる
- `docs/cycles/backlog/` に同名ファイルが既に存在する
```

現状では同名ファイルが存在する場合、サイレントにスキップされ、ユーザーへの明示的な警告がない。

### 問題点

バックログのバグレポート（`chore-backlog-migration-duplicate-handling.md`）によると：
- 異なる内容を持つ項目が同じタイトルを持つ場合、片方がスキップされる
- ユーザーは重複によるスキップを認識できない可能性がある

## 変更内容

### Phase 1: 設計（コードなし）

1. **ドメインモデル設計**
   - 重複検出のドメインロジック定義
   - 警告メッセージの形式定義

2. **論理設計**
   - 移行フローへの警告ステップ組み込み
   - 移行結果サマリへの重複ファイル名リスト追加

### Phase 2: 実装

1. **修正対象ファイル**
   - `prompts/package/prompts/setup.md`

2. **具体的な変更**
   - スキップ条件の説明に「警告を表示」を追加
   - 移行結果サマリに重複でスキップしたファイル名リストを追加

## 成果物

| 種別 | ファイルパス |
|------|-------------|
| ドメインモデル | `docs/cycles/v1.5.4/design-artifacts/domain-models/006_domain_model.md` |
| 論理設計 | `docs/cycles/v1.5.4/design-artifacts/logical-designs/006_logical_design.md` |
| 実装 | `prompts/package/prompts/setup.md` (修正) |
| 実装記録 | `docs/cycles/v1.5.4/construction/units/006_implementation.md` |

## スコープ外

- 移行処理自体のロジック変更
- 重複時の自動リネーム機能（警告のみ実装）
- backlog.md以外の移行処理

## テスト方針

- プロンプトファイルの修正のためコードテストは不要
- 手動確認: setup.md の指示が明確で一貫しているか確認

---

**計画作成日**: 2026-01-08
