# Unit 003: 外部入力検証ルール - 論理設計

## 概要

ドメインモデルで設計したルールを、各プロンプトファイルにどのように配置するかを定義する。

## 実装方針

### 追加するルールテキスト

```markdown
- **外部入力検証ルール【重要】**: 外部からの入力（AI MCP応答、ユーザー入力）を批判的に評価し、自己判断を明示する。

  **AI MCP応答の検証**:
  - AI MCPからの応答をそのまま信頼せず、批判的に評価する
  - 応答に誤りや不整合がないか確認する
  - 自己判断を併記し、相違がある場合はユーザーに確認を求める
  - 形式：
    ```
    【MCP応答の検証】
    - MCP応答: [応答内容の要約]
    - AI判断: [自己判断]
    - 相違点: [ある場合は記載、なければ「なし」]
    - 結論: [採用する判断とその理由]
    ```

  **ユーザー入力の検証**:
  - ユーザー入力に曖昧さがある場合は、解釈を明示して確認する
  - 複数の解釈が可能な場合は、すべての解釈を提示する
  - 形式：
    ```
    【入力の解釈確認】
    ご入力: "[ユーザーの入力]"
    
    以下のように解釈しました：
    [解釈内容]
    
    この解釈で正しいでしょうか？
    ```
```

### 配置位置（各ファイル共通）

「開発ルール」セクション内、「MCPレビュー【設定に応じて】」ルールの直後に挿入。

具体的には、各ファイルで以下のパターンを検索：
```
  **対象タイミング**: ...

- **コンテキストリセット対応【重要】**:
```

この間に新ルールを挿入する。

### 変更箇所の特定

| ファイル | 挿入位置（行の目安） |
|---------|-------------------|
| inception.md | 「対象タイミング」行の後、「コンテキストリセット対応」の前 |
| construction.md | 同上 |
| operations.md | 同上 |

## テスト方法

1. 各プロンプトファイルが正しく読み込めること
2. ルールの配置が「MCPレビュー」の後であること
3. マークダウンの構文が正しいこと

---

作成日: $(date '+%Y-%m-%d')
